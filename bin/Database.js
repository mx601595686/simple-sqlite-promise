"use strict";
/**
 * Created by 吴劲韬 on 2017/3/13.
 */
const sqlite3 = require("sqlite3");
class Database {
    constructor(
    /**
     * 原始的sqlite3数据库连接
     */
    _db) {
        this._db = _db;
    }
    static get OPEN_READONLY() {
        return sqlite3.OPEN_READONLY;
    }
    static get OPEN_READWRITE() {
        return sqlite3.OPEN_READWRITE;
    }
    static get OPEN_CREATE() {
        return sqlite3.OPEN_CREATE;
    }
    /**
     * 开启以显示更多的错误消息。注意！这会严重影响数据库的性能
     */
    static verbose() {
        sqlite3.verbose();
        return Database;
    }
    /**
     * 根据文件路径异步打开sqlite数据库
     * @param filename sqlite数据库的文件路径
     * @param mode 连接模式。默认 mode=Database.OPEN_CREATE | Database.OPEN_READWRITE
     * @param cached 是否使用之前打开过的连接，默认false
     */
    static connectDB(filename, mode, cached) {
        return new Promise(function (resolve, reject) {
            mode = mode === undefined ? Database.OPEN_CREATE | Database.OPEN_READWRITE : mode;
            if (cached === true) {
                const db = sqlite3.cached.Database(filename, mode, function (err) {
                    err ? reject(err) : resolve(new Database(db));
                });
            }
            else {
                const db = new sqlite3.Database(filename, mode, function (err) {
                    err ? reject(err) : resolve(new Database(db));
                });
            }
        });
    }
    /**
     * 关闭数据库连接
     */
    close() {
        return new Promise((resolve, reject) => {
            this._db.close(err => err ? reject(err) : resolve());
        });
    }
    on(event, callback) {
        this._db.on(event, callback);
    }
    /**
     * 执行"单条"sql语句(多条语句只执行第一条)，不返回sql执行结果。如果执行的是INSERT操作则返回插入id lastID，如果是UPDATE或DELETE 则会返回受影响的行数changes
     * @param sql 执行的sql语句
     * @param param 如果sql中使用了占位符，则可在这传递参数
     */
    run(sql, ...param) {
        return new Promise((resolve, reject) => {
            this._db.run(sql, ...param, function (err) {
                err ? reject(err) : resolve({ lastID: this.lastID, changes: this.changes });
            });
        });
    }
    /**
     * 执行一条sql查询，返回第一行结果。结果按照{列名：值}键值对的形式返回。如果查询结果为空则返回空
     * @param sql sql查询语句
     * @param param 如果sql中使用了占位符，则可在这传递参数
     */
    get(sql, ...param) {
        return new Promise((resolve, reject) => {
            this._db.get(sql, param, function (err, row) {
                err ? reject(err) : resolve(row);
            });
        });
    }
    /**
     * 执行一条sql查询，返回所有结果。结果按照{列名：值}键值对数组的形式返回。如果查询结果为空则返回空数组
     * @param sql sql查询语句
     * @param param 如果sql中使用了占位符，则可在这传递参数
     */
    all(sql, ...param) {
        return new Promise((resolve, reject) => {
            this._db.all(sql, param, function (err, rows) {
                err ? reject(err) : resolve(rows);
            });
        });
    }
    /**
     * 执行多条sql语句，不返回任何结果。如果其中一条sql语句执行失败，则后续的sql语句将不会被执行（可以利用事务包裹所有语句来确保执行结果与预料一致）。
     *
     * @param {string} sql 要执行的sql语句
     * @returns {Promise<void>}
     *
     * @memberOf Database
     */
    exec(sql) {
        return new Promise((resolve, reject) => {
            this._db.exec(sql, function (err) {
                err ? reject(err) : resolve();
            });
        });
    }
}
module.exports = Database;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRhdGFiYXNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRztBQUNILG1DQUFvQztBQUVwQyxNQUFNLFFBQVE7SUE0Q1Y7SUFDSTs7T0FFRztJQUNLLEdBQXFCO1FBQXJCLFFBQUcsR0FBSCxHQUFHLENBQWtCO0lBQzdCLENBQUM7SUEvQ0wsTUFBTSxLQUFLLGFBQWE7UUFDcEIsT0FBTyxPQUFPLENBQUMsYUFBYSxDQUFDO0lBQ2pDLENBQUM7SUFFRCxNQUFNLEtBQUssY0FBYztRQUNyQixPQUFPLE9BQU8sQ0FBQyxjQUFjLENBQUM7SUFDbEMsQ0FBQztJQUVELE1BQU0sS0FBSyxXQUFXO1FBQ2xCLE9BQU8sT0FBTyxDQUFDLFdBQVcsQ0FBQztJQUMvQixDQUFDO0lBRUQ7O09BRUc7SUFDSCxNQUFNLENBQUMsT0FBTztRQUNWLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNsQixPQUFPLFFBQVEsQ0FBQztJQUNwQixDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQWdCLEVBQUUsSUFBYSxFQUFFLE1BQWdCO1FBQzlELE9BQU8sSUFBSSxPQUFPLENBQVcsVUFBVSxPQUFPLEVBQUUsTUFBTTtZQUNsRCxJQUFJLEdBQUcsSUFBSSxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFdBQVcsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7WUFFbEYsSUFBSSxNQUFNLEtBQUssSUFBSSxFQUFFO2dCQUNqQixNQUFNLEVBQUUsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsSUFBSSxFQUFFLFVBQVUsR0FBRztvQkFDNUQsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNsRCxDQUFDLENBQUMsQ0FBQzthQUNOO2lCQUFNO2dCQUNILE1BQU0sRUFBRSxHQUFHLElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsSUFBSSxFQUFFLFVBQVUsR0FBRztvQkFDekQsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNsRCxDQUFDLENBQUMsQ0FBQzthQUNOO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBU0Q7O09BRUc7SUFDSCxLQUFLO1FBQ0QsT0FBTyxJQUFJLE9BQU8sQ0FBTyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsRUFBRTtZQUN6QyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQ3pELENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQU1ELEVBQUUsQ0FBQyxLQUFhLEVBQUUsUUFBbUM7UUFDakQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsR0FBRyxDQUFDLEdBQVcsRUFBRSxHQUFHLEtBQVk7UUFDNUIsT0FBTyxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsRUFBRTtZQUNuQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxLQUFLLEVBQUUsVUFBbUMsR0FBVTtnQkFDckUsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztZQUNoRixDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxHQUFHLENBQUMsR0FBVyxFQUFFLEdBQUcsS0FBWTtRQUM1QixPQUFPLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ25DLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsVUFBVSxHQUFVLEVBQUUsR0FBUTtnQkFDbkQsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNyQyxDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxHQUFHLENBQUMsR0FBVyxFQUFFLEdBQUcsS0FBWTtRQUM1QixPQUFPLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ25DLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsVUFBVSxHQUFVLEVBQUUsSUFBVztnQkFDdEQsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN0QyxDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOzs7Ozs7O09BT0c7SUFDSCxJQUFJLENBQUMsR0FBVztRQUNaLE9BQU8sSUFBSSxPQUFPLENBQU8sQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7WUFDekMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLFVBQVUsR0FBRztnQkFDNUIsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ2xDLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0NBQ0o7QUFFRCxpQkFBUyxRQUFRLENBQUMiLCJmaWxlIjoiRGF0YWJhc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkg5ZC05Yqy6Z+sIG9uIDIwMTcvMy8xMy5cbiAqL1xuaW1wb3J0IHNxbGl0ZTMgPSByZXF1aXJlKCdzcWxpdGUzJyk7XG5cbmNsYXNzIERhdGFiYXNlIHtcblxuICAgIHN0YXRpYyBnZXQgT1BFTl9SRUFET05MWSgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gc3FsaXRlMy5PUEVOX1JFQURPTkxZO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXQgT1BFTl9SRUFEV1JJVEUoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHNxbGl0ZTMuT1BFTl9SRUFEV1JJVEU7XG4gICAgfVxuXG4gICAgc3RhdGljIGdldCBPUEVOX0NSRUFURSgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gc3FsaXRlMy5PUEVOX0NSRUFURTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDlvIDlkK/ku6XmmL7npLrmm7TlpJrnmoTplJnor6/mtojmga/jgILms6jmhI/vvIHov5nkvJrkuKXph43lvbHlk43mlbDmja7lupPnmoTmgKfog71cbiAgICAgKi9cbiAgICBzdGF0aWMgdmVyYm9zZSgpOiB0eXBlb2YgRGF0YWJhc2Uge1xuICAgICAgICBzcWxpdGUzLnZlcmJvc2UoKTtcbiAgICAgICAgcmV0dXJuIERhdGFiYXNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIOagueaNruaWh+S7tui3r+W+hOW8guatpeaJk+W8gHNxbGl0ZeaVsOaNruW6k1xuICAgICAqIEBwYXJhbSBmaWxlbmFtZSBzcWxpdGXmlbDmja7lupPnmoTmlofku7bot6/lvoRcbiAgICAgKiBAcGFyYW0gbW9kZSDov57mjqXmqKHlvI/jgILpu5jorqQgbW9kZT1EYXRhYmFzZS5PUEVOX0NSRUFURSB8IERhdGFiYXNlLk9QRU5fUkVBRFdSSVRFXG4gICAgICogQHBhcmFtIGNhY2hlZCDmmK/lkKbkvb/nlKjkuYvliY3miZPlvIDov4fnmoTov57mjqXvvIzpu5jorqRmYWxzZVxuICAgICAqL1xuICAgIHN0YXRpYyBjb25uZWN0REIoZmlsZW5hbWU6IHN0cmluZywgbW9kZT86IG51bWJlciwgY2FjaGVkPzogYm9vbGVhbik6IFByb21pc2U8RGF0YWJhc2U+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPERhdGFiYXNlPihmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBtb2RlID0gbW9kZSA9PT0gdW5kZWZpbmVkID8gRGF0YWJhc2UuT1BFTl9DUkVBVEUgfCBEYXRhYmFzZS5PUEVOX1JFQURXUklURSA6IG1vZGU7XG5cbiAgICAgICAgICAgIGlmIChjYWNoZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYiA9IHNxbGl0ZTMuY2FjaGVkLkRhdGFiYXNlKGZpbGVuYW1lLCBtb2RlLCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVyciA/IHJlamVjdChlcnIpIDogcmVzb2x2ZShuZXcgRGF0YWJhc2UoZGIpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGIgPSBuZXcgc3FsaXRlMy5EYXRhYmFzZShmaWxlbmFtZSwgbW9kZSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIgPyByZWplY3QoZXJyKSA6IHJlc29sdmUobmV3IERhdGFiYXNlKGRiKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgY29uc3RydWN0b3IoXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDljp/lp4vnmoRzcWxpdGUz5pWw5o2u5bqT6L+e5o6lXG4gICAgICAgICAqL1xuICAgICAgICBwcml2YXRlIF9kYjogc3FsaXRlMy5EYXRhYmFzZVxuICAgICkgeyB9XG5cbiAgICAvKipcbiAgICAgKiDlhbPpl63mlbDmja7lupPov57mjqVcbiAgICAgKi9cbiAgICBjbG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2RiLmNsb3NlKGVyciA9PiBlcnIgPyByZWplY3QoZXJyKSA6IHJlc29sdmUoKSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uKGV2ZW50OiBcInRyYWNlXCIsIGxpc3RlbmVyOiAoc3FsOiBzdHJpbmcpID0+IHZvaWQpOiB2b2lkO1xuICAgIG9uKGV2ZW50OiBcInByb2ZpbGVcIiwgbGlzdGVuZXI6IChzcWw6IHN0cmluZywgdGltZTogbnVtYmVyKSA9PiB2b2lkKTogdm9pZDtcbiAgICBvbihldmVudDogXCJlcnJvclwiLCBsaXN0ZW5lcjogKGVycjogRXJyb3IpID0+IHZvaWQpOiB2b2lkO1xuICAgIG9uKGV2ZW50OiBcIm9wZW5cIiB8IFwiY2xvc2VcIiwgbGlzdGVuZXI6ICgpID0+IHZvaWQpOiB2b2lkO1xuICAgIG9uKGV2ZW50OiBzdHJpbmcsIGNhbGxiYWNrOiAoLi4ucGFyYW06IGFueVtdKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2RiLm9uKGV2ZW50LCBjYWxsYmFjayk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog5omn6KGMXCLljZXmnaFcInNxbOivreWPpSjlpJrmnaHor63lj6Xlj6rmiafooYznrKzkuIDmnaEp77yM5LiN6L+U5Zuec3Fs5omn6KGM57uT5p6c44CC5aaC5p6c5omn6KGM55qE5pivSU5TRVJU5pON5L2c5YiZ6L+U5Zue5o+S5YWlaWQgbGFzdElE77yM5aaC5p6c5pivVVBEQVRF5oiWREVMRVRFIOWImeS8mui/lOWbnuWPl+W9seWTjeeahOihjOaVsGNoYW5nZXNcbiAgICAgKiBAcGFyYW0gc3FsIOaJp+ihjOeahHNxbOivreWPpVxuICAgICAqIEBwYXJhbSBwYXJhbSDlpoLmnpxzcWzkuK3kvb/nlKjkuobljaDkvY3nrKbvvIzliJnlj6/lnKjov5nkvKDpgJLlj4LmlbBcbiAgICAgKi9cbiAgICBydW4oc3FsOiBzdHJpbmcsIC4uLnBhcmFtOiBhbnlbXSk6IFByb21pc2U8eyBsYXN0SUQ6IG51bWJlciwgY2hhbmdlczogbnVtYmVyIH0+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2RiLnJ1bihzcWwsIC4uLnBhcmFtLCBmdW5jdGlvbiAodGhpczogc3FsaXRlMy5SdW5SZXN1bHQsIGVycjogRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBlcnIgPyByZWplY3QoZXJyKSA6IHJlc29sdmUoeyBsYXN0SUQ6IHRoaXMubGFzdElELCBjaGFuZ2VzOiB0aGlzLmNoYW5nZXMgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog5omn6KGM5LiA5p2hc3Fs5p+l6K+i77yM6L+U5Zue56ys5LiA6KGM57uT5p6c44CC57uT5p6c5oyJ54Wne+WIl+WQje+8muWAvH3plK7lgLzlr7nnmoTlvaLlvI/ov5Tlm57jgILlpoLmnpzmn6Xor6Lnu5PmnpzkuLrnqbrliJnov5Tlm57nqbpcbiAgICAgKiBAcGFyYW0gc3FsIHNxbOafpeivouivreWPpVxuICAgICAqIEBwYXJhbSBwYXJhbSDlpoLmnpxzcWzkuK3kvb/nlKjkuobljaDkvY3nrKbvvIzliJnlj6/lnKjov5nkvKDpgJLlj4LmlbBcbiAgICAgKi9cbiAgICBnZXQoc3FsOiBzdHJpbmcsIC4uLnBhcmFtOiBhbnlbXSk6IFByb21pc2U8YW55PiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9kYi5nZXQoc3FsLCBwYXJhbSwgZnVuY3Rpb24gKGVycjogRXJyb3IsIHJvdzogYW55KSB7XG4gICAgICAgICAgICAgICAgZXJyID8gcmVqZWN0KGVycikgOiByZXNvbHZlKHJvdyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog5omn6KGM5LiA5p2hc3Fs5p+l6K+i77yM6L+U5Zue5omA5pyJ57uT5p6c44CC57uT5p6c5oyJ54Wne+WIl+WQje+8muWAvH3plK7lgLzlr7nmlbDnu4TnmoTlvaLlvI/ov5Tlm57jgILlpoLmnpzmn6Xor6Lnu5PmnpzkuLrnqbrliJnov5Tlm57nqbrmlbDnu4RcbiAgICAgKiBAcGFyYW0gc3FsIHNxbOafpeivouivreWPpVxuICAgICAqIEBwYXJhbSBwYXJhbSDlpoLmnpxzcWzkuK3kvb/nlKjkuobljaDkvY3nrKbvvIzliJnlj6/lnKjov5nkvKDpgJLlj4LmlbBcbiAgICAgKi9cbiAgICBhbGwoc3FsOiBzdHJpbmcsIC4uLnBhcmFtOiBhbnlbXSk6IFByb21pc2U8YW55W10+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2RiLmFsbChzcWwsIHBhcmFtLCBmdW5jdGlvbiAoZXJyOiBFcnJvciwgcm93czogYW55W10pIHtcbiAgICAgICAgICAgICAgICBlcnIgPyByZWplY3QoZXJyKSA6IHJlc29sdmUocm93cyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog5omn6KGM5aSa5p2hc3Fs6K+t5Y+l77yM5LiN6L+U5Zue5Lu75L2V57uT5p6c44CC5aaC5p6c5YW25Lit5LiA5p2hc3Fs6K+t5Y+l5omn6KGM5aSx6LSl77yM5YiZ5ZCO57ut55qEc3Fs6K+t5Y+l5bCG5LiN5Lya6KKr5omn6KGM77yI5Y+v5Lul5Yip55So5LqL5Yqh5YyF6KO55omA5pyJ6K+t5Y+l5p2l56Gu5L+d5omn6KGM57uT5p6c5LiO6aKE5paZ5LiA6Ie077yJ44CCXG4gICAgICogXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNxbCDopoHmiafooYznmoRzcWzor63lj6VcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn0gXG4gICAgICogXG4gICAgICogQG1lbWJlck9mIERhdGFiYXNlXG4gICAgICovXG4gICAgZXhlYyhzcWw6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fZGIuZXhlYyhzcWwsIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICBlcnIgPyByZWplY3QoZXJyKSA6IHJlc29sdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmV4cG9ydCA9IERhdGFiYXNlOyJdfQ==
